import { Callout } from 'nextra/components'

# 04. JavaScriptæ ¸å¿ƒåŸç†å’ŒES6+

## ğŸ“‹ ç›®å½•

- [JavaScriptå¼•æ“åŸç†](#javascriptå¼•æ“åŸç†)
- [æ‰§è¡Œä¸Šä¸‹æ–‡å’Œä½œç”¨åŸŸ](#æ‰§è¡Œä¸Šä¸‹æ–‡å’Œä½œç”¨åŸŸ)
- [åŸå‹é“¾å’Œç»§æ‰¿](#åŸå‹é“¾å’Œç»§æ‰¿)
- [å¼‚æ­¥ç¼–ç¨‹æ·±å…¥](#å¼‚æ­¥ç¼–ç¨‹æ·±å…¥)
- [ES6+æ–°ç‰¹æ€§è¯¦è§£](#es6æ–°ç‰¹æ€§è¯¦è§£)
- [æ¨¡å—åŒ–å¼€å‘](#æ¨¡å—åŒ–å¼€å‘)

## JavaScriptå¼•æ“åŸç†

<Callout type="info">
ç†è§£[JavaScript](https://developer.mozilla.org/en-US/docs/Web/JavaScript)å¼•æ“çš„å·¥ä½œåŸç†æ˜¯æŒæ¡JavaScriptçš„å…³é”®ï¼Œå®ƒå¸®åŠ©æˆ‘ä»¬å†™å‡ºæ›´é«˜æ•ˆçš„ä»£ç ã€‚
</Callout>

### V8å¼•æ“æ¶æ„

[V8](https://v8.dev/)æ˜¯[Google Chrome](https://www.google.com/chrome/)å’Œ[Node.js](https://nodejs.org/)ä½¿ç”¨çš„JavaScriptå¼•æ“ã€‚

```javascript
// JavaScriptä»£ç æ‰§è¡Œè¿‡ç¨‹
/*
1. è¯æ³•åˆ†æï¼ˆLexical Analysisï¼‰
   - å°†æºä»£ç åˆ†è§£ä¸ºtokens

2. è¯­æ³•åˆ†æï¼ˆSyntax Analysisï¼‰
   - å°†tokensè½¬æ¢ä¸ºæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰

3. å­—èŠ‚ç ç”Ÿæˆ
   - å°†ASTè½¬æ¢ä¸ºå­—èŠ‚ç 

4. æ‰§è¡Œ
   - è§£é‡Šå™¨æ‰§è¡Œå­—èŠ‚ç 
   - ä¼˜åŒ–ç¼–è¯‘å™¨ï¼ˆTurboFanï¼‰ä¼˜åŒ–çƒ­ç‚¹ä»£ç 
*/

// ç¤ºä¾‹ï¼šå˜é‡æå‡çš„åŸç†
console.log(a); // undefinedï¼ˆä¸æ˜¯æŠ¥é”™ï¼‰
var a = 5;

// å®é™…æ‰§è¡Œè¿‡ç¨‹ï¼š
// 1. ç¼–è¯‘é˜¶æ®µï¼švar a; ï¼ˆå£°æ˜æå‡ï¼‰
// 2. æ‰§è¡Œé˜¶æ®µï¼šconsole.log(a); a = 5;

// å‡½æ•°æå‡
console.log(foo()); // "Hello"

function foo() {
  return "Hello";
}

// let/constçš„æš‚æ—¶æ€§æ­»åŒº
console.log(b); // ReferenceError
let b = 10;
```

### å†…å­˜ç®¡ç†å’Œåƒåœ¾å›æ”¶

```javascript
// å†…å­˜åˆ†é…ç¤ºä¾‹
function createObjects() {
  // æ ˆå†…å­˜ï¼šå­˜å‚¨åŸºæœ¬ç±»å‹å’Œå¼•ç”¨
  let num = 42;
  let str = "Hello";
  
  // å †å†…å­˜ï¼šå­˜å‚¨å¯¹è±¡
  let obj = {
    name: "JavaScript",
    version: "ES2024"
  };
  
  // é—­åŒ…ä¼šä¿æŒå¯¹å¤–éƒ¨å˜é‡çš„å¼•ç”¨
  function closure() {
    return obj.name; // objä¸ä¼šè¢«åƒåœ¾å›æ”¶
  }
  
  return closure;
}

// åƒåœ¾å›æ”¶æœºåˆ¶
/*
1. æ ‡è®°æ¸…é™¤ï¼ˆMark and Sweepï¼‰- ä¸»è¦ç®—æ³•
   - æ ‡è®°é˜¶æ®µï¼šä»æ ¹å¯¹è±¡å¼€å§‹ï¼Œæ ‡è®°æ‰€æœ‰å¯è¾¾å¯¹è±¡
   - æ¸…é™¤é˜¶æ®µï¼šæ¸…é™¤æœªæ ‡è®°çš„å¯¹è±¡

2. å¼•ç”¨è®¡æ•°ï¼ˆReference Countingï¼‰- è¾…åŠ©ç®—æ³•
   - è·Ÿè¸ªæ¯ä¸ªå¯¹è±¡çš„å¼•ç”¨æ¬¡æ•°
   - å¼•ç”¨æ¬¡æ•°ä¸º0æ—¶ç«‹å³å›æ”¶
   - é—®é¢˜ï¼šå¾ªç¯å¼•ç”¨
*/

// é¿å…å†…å­˜æ³„æ¼çš„æœ€ä½³å®è·µ
class MemoryManager {
  constructor() {
    this.listeners = new Map();
    this.timers = new Set();
  }
  
  // æ­£ç¡®ç®¡ç†äº‹ä»¶ç›‘å¬å™¨
  addEventListener(element, event, handler) {
    element.addEventListener(event, handler);
    
    if (!this.listeners.has(element)) {
      this.listeners.set(element, new Map());
    }
    this.listeners.get(element).set(event, handler);
  }
  
  // æ¸…ç†äº‹ä»¶ç›‘å¬å™¨
  removeEventListener(element, event) {
    if (this.listeners.has(element)) {
      const elementListeners = this.listeners.get(element);
      const handler = elementListeners.get(event);
      
      if (handler) {
        element.removeEventListener(event, handler);
        elementListeners.delete(event);
      }
    }
  }
  
  // ç®¡ç†å®šæ—¶å™¨
  setTimeout(callback, delay) {
    const timerId = setTimeout(() => {
      callback();
      this.timers.delete(timerId);
    }, delay);
    
    this.timers.add(timerId);
    return timerId;
  }
  
  // æ¸…ç†æ‰€æœ‰èµ„æº
  cleanup() {
    // æ¸…ç†äº‹ä»¶ç›‘å¬å™¨
    for (const [element, events] of this.listeners) {
      for (const [event, handler] of events) {
        element.removeEventListener(event, handler);
      }
    }
    this.listeners.clear();
    
    // æ¸…ç†å®šæ—¶å™¨
    for (const timerId of this.timers) {
      clearTimeout(timerId);
    }
    this.timers.clear();
  }
}
```

## æ‰§è¡Œä¸Šä¸‹æ–‡å’Œä½œç”¨åŸŸ

### æ‰§è¡Œä¸Šä¸‹æ–‡è¯¦è§£

<Callout type="warning">
æ‰§è¡Œä¸Šä¸‹æ–‡æ˜¯JavaScriptä»£ç æ‰§è¡Œçš„ç¯å¢ƒï¼Œç†è§£å®ƒå¯¹äºæŒæ¡thisç»‘å®šã€å˜é‡æå‡ç­‰æ¦‚å¿µè‡³å…³é‡è¦ã€‚
</Callout>

```javascript
// æ‰§è¡Œä¸Šä¸‹æ–‡çš„ç»„æˆ
/*
1. å˜é‡å¯¹è±¡ï¼ˆVariable Objectï¼‰/ è¯æ³•ç¯å¢ƒï¼ˆLexical Environmentï¼‰
2. ä½œç”¨åŸŸé“¾ï¼ˆScope Chainï¼‰
3. thisç»‘å®š
*/

// å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡
var globalVar = "global";

function outerFunction(x) {
  // å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡
  var outerVar = "outer";
  
  function innerFunction(y) {
    // å†…éƒ¨å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡
    var innerVar = "inner";
    
    // ä½œç”¨åŸŸé“¾ï¼šinnerFunction -> outerFunction -> global
    console.log(innerVar); // "inner"
    console.log(outerVar); // "outer"
    console.log(globalVar); // "global"
    console.log(x, y); // å‚æ•°ä¹Ÿåœ¨ä½œç”¨åŸŸé“¾ä¸­
  }
  
  return innerFunction;
}

const inner = outerFunction("param");
inner("arg");

// è¯æ³•ä½œç”¨åŸŸ vs åŠ¨æ€ä½œç”¨åŸŸ
function lexicalScope() {
  var name = "lexical";
  
  function inner() {
    console.log(name); // è¯æ³•ä½œç”¨åŸŸï¼šåœ¨å®šä¹‰æ—¶ç¡®å®š
  }
  
  return inner;
}

function dynamicScope() {
  var name = "dynamic";
  lexicalScope()(); // ä»ç„¶è¾“å‡º "lexical"
}

dynamicScope();
```

### thisç»‘å®šè§„åˆ™

```javascript
// thisç»‘å®šçš„å››ç§è§„åˆ™

// 1. é»˜è®¤ç»‘å®š
function defaultBinding() {
  console.log(this); // ä¸¥æ ¼æ¨¡å¼ä¸‹æ˜¯undefinedï¼Œéä¸¥æ ¼æ¨¡å¼ä¸‹æ˜¯window
}

// 2. éšå¼ç»‘å®š
const obj = {
  name: "Object",
  greet() {
    console.log(this.name); // "Object"
  }
};

obj.greet(); // éšå¼ç»‘å®š

const greetFunc = obj.greet;
greetFunc(); // é»˜è®¤ç»‘å®šï¼Œthisä¸¢å¤±

// 3. æ˜¾å¼ç»‘å®š
function explicitBinding() {
  console.log(this.name);
}

const context = { name: "Explicit" };
explicitBinding.call(context); // "Explicit"
explicitBinding.apply(context); // "Explicit"

const boundFunction = explicitBinding.bind(context);
boundFunction(); // "Explicit"

// 4. newç»‘å®š
function Constructor(name) {
  this.name = name;
  this.greet = function() {
    console.log(`Hello, ${this.name}`);
  };
}

const instance = new Constructor("Instance");
instance.greet(); // "Hello, Instance"

// ç®­å¤´å‡½æ•°çš„this
const arrowObj = {
  name: "Arrow",
  regularFunction() {
    console.log(this.name); // "Arrow"
    
    const arrowFunction = () => {
      console.log(this.name); // "Arrow" - ç»§æ‰¿å¤–å±‚this
    };
    
    arrowFunction();
  }
};

arrowObj.regularFunction();

// å®é™…åº”ç”¨ï¼šè§£å†³thisä¸¢å¤±é—®é¢˜
class EventHandler {
  constructor(name) {
    this.name = name;
  }
  
  // æ–¹æ³•1ï¼šç®­å¤´å‡½æ•°
  handleClick = (event) => {
    console.log(`${this.name} clicked`);
  }
  
  // æ–¹æ³•2ï¼šbindç»‘å®š
  handleSubmit(event) {
    console.log(`${this.name} submitted`);
  }
  
  init() {
    const button = document.querySelector('#button');
    const form = document.querySelector('#form');
    
    button.addEventListener('click', this.handleClick); // æ­£ç¡®
    form.addEventListener('submit', this.handleSubmit.bind(this)); // æ­£ç¡®
  }
}
```

## åŸå‹é“¾å’Œç»§æ‰¿

### åŸå‹é“¾æœºåˆ¶

```javascript
// åŸå‹é“¾çš„åŸºæœ¬æ¦‚å¿µ
function Person(name) {
  this.name = name;
}

Person.prototype.greet = function() {
  return `Hello, I'm ${this.name}`;
};

const person = new Person("Alice");

// åŸå‹é“¾æŸ¥æ‰¾è¿‡ç¨‹
console.log(person.greet()); // åœ¨Person.prototypeä¸Šæ‰¾åˆ°
console.log(person.toString()); // åœ¨Object.prototypeä¸Šæ‰¾åˆ°

// åŸå‹é“¾ï¼šperson -> Person.prototype -> Object.prototype -> null

// æ‰‹åŠ¨å®ç°newæ“ä½œç¬¦
function myNew(constructor, ...args) {
  // 1. åˆ›å»ºæ–°å¯¹è±¡ï¼ŒåŸå‹æŒ‡å‘æ„é€ å‡½æ•°çš„prototype
  const obj = Object.create(constructor.prototype);
  
  // 2. æ‰§è¡Œæ„é€ å‡½æ•°ï¼ŒthisæŒ‡å‘æ–°å¯¹è±¡
  const result = constructor.apply(obj, args);
  
  // 3. å¦‚æœæ„é€ å‡½æ•°è¿”å›å¯¹è±¡ï¼Œåˆ™è¿”å›è¯¥å¯¹è±¡ï¼Œå¦åˆ™è¿”å›æ–°å¯¹è±¡
  return result instanceof Object ? result : obj;
}

const person2 = myNew(Person, "Bob");
console.log(person2.greet()); // "Hello, I'm Bob"

// åŸå‹é“¾ç»§æ‰¿çš„å®ç°
function Animal(name) {
  this.name = name;
}

Animal.prototype.speak = function() {
  return `${this.name} makes a sound`;
};

function Dog(name, breed) {
  // è°ƒç”¨çˆ¶æ„é€ å‡½æ•°
  Animal.call(this, name);
  this.breed = breed;
}

// è®¾ç½®åŸå‹é“¾
Dog.prototype = Object.create(Animal.prototype);
Dog.prototype.constructor = Dog;

// æ·»åŠ å­ç±»æ–¹æ³•
Dog.prototype.bark = function() {
  return `${this.name} barks`;
};

const dog = new Dog("Buddy", "Golden Retriever");
console.log(dog.speak()); // "Buddy makes a sound"
console.log(dog.bark()); // "Buddy barks"
```

### ES6ç±»å’Œç»§æ‰¿

```javascript
// ES6ç±»è¯­æ³•
class Animal {
  constructor(name) {
    this.name = name;
  }
  
  speak() {
    return `${this.name} makes a sound`;
  }
  
  // é™æ€æ–¹æ³•
  static getSpecies() {
    return "Unknown";
  }
  
  // ç§æœ‰å­—æ®µï¼ˆES2022ï¼‰
  #privateField = "private";
  
  // ç§æœ‰æ–¹æ³•
  #privateMethod() {
    return this.#privateField;
  }
  
  // å…¬å…±æ–¹æ³•è®¿é—®ç§æœ‰æˆå‘˜
  getPrivateData() {
    return this.#privateMethod();
  }
}

// ç»§æ‰¿
class Dog extends Animal {
  constructor(name, breed) {
    super(name); // è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°
    this.breed = breed;
  }
  
  speak() {
    return `${super.speak()} - Woof!`; // è°ƒç”¨çˆ¶ç±»æ–¹æ³•
  }
  
  bark() {
    return `${this.name} barks`;
  }
  
  static getSpecies() {
    return "Canis lupus";
  }
}

const dog = new Dog("Max", "Labrador");
console.log(dog.speak()); // "Max makes a sound - Woof!"
console.log(Dog.getSpecies()); // "Canis lupus"

// Mixinæ¨¡å¼
const Flyable = {
  fly() {
    return `${this.name} is flying`;
  }
};

const Swimmable = {
  swim() {
    return `${this.name} is swimming`;
  }
};

// ç»„åˆå¤šä¸ªèƒ½åŠ›
class Duck extends Animal {
  constructor(name) {
    super(name);
  }
}

// æ·»åŠ mixin
Object.assign(Duck.prototype, Flyable, Swimmable);

const duck = new Duck("Donald");
console.log(duck.fly()); // "Donald is flying"
console.log(duck.swim()); // "Donald is swimming"
```

## å¼‚æ­¥ç¼–ç¨‹æ·±å…¥

### PromiseåŸç†å’Œå®ç°

<Callout type="info">
Promiseæ˜¯JavaScriptå¼‚æ­¥ç¼–ç¨‹çš„æ ¸å¿ƒï¼Œç†è§£å…¶åŸç†æœ‰åŠ©äºæ›´å¥½åœ°å¤„ç†å¼‚æ­¥æ“ä½œã€‚
</Callout>

```javascript
// æ‰‹åŠ¨å®ç°Promise
class MyPromise {
  constructor(executor) {
    this.state = 'pending';
    this.value = undefined;
    this.reason = undefined;
    this.onFulfilledCallbacks = [];
    this.onRejectedCallbacks = [];
    
    const resolve = (value) => {
      if (this.state === 'pending') {
        this.state = 'fulfilled';
        this.value = value;
        this.onFulfilledCallbacks.forEach(callback => callback());
      }
    };
    
    const reject = (reason) => {
      if (this.state === 'pending') {
        this.state = 'rejected';
        this.reason = reason;
        this.onRejectedCallbacks.forEach(callback => callback());
      }
    };
    
    try {
      executor(resolve, reject);
    } catch (error) {
      reject(error);
    }
  }
  
  then(onFulfilled, onRejected) {
    onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : value => value;
    onRejected = typeof onRejected === 'function' ? onRejected : reason => { throw reason; };
    
    return new MyPromise((resolve, reject) => {
      const handleFulfilled = () => {
        try {
          const result = onFulfilled(this.value);
          resolve(result);
        } catch (error) {
          reject(error);
        }
      };
      
      const handleRejected = () => {
        try {
          const result = onRejected(this.reason);
          resolve(result);
        } catch (error) {
          reject(error);
        }
      };
      
      if (this.state === 'fulfilled') {
        setTimeout(handleFulfilled, 0);
      } else if (this.state === 'rejected') {
        setTimeout(handleRejected, 0);
      } else {
        this.onFulfilledCallbacks.push(handleFulfilled);
        this.onRejectedCallbacks.push(handleRejected);
      }
    });
  }
  
  catch(onRejected) {
    return this.then(null, onRejected);
  }
  
  finally(onFinally) {
    return this.then(
      value => MyPromise.resolve(onFinally()).then(() => value),
      reason => MyPromise.resolve(onFinally()).then(() => { throw reason; })
    );
  }
  
  static resolve(value) {
    return new MyPromise(resolve => resolve(value));
  }
  
  static reject(reason) {
    return new MyPromise((resolve, reject) => reject(reason));
  }
  
  static all(promises) {
    return new MyPromise((resolve, reject) => {
      const results = [];
      let completedCount = 0;
      
      promises.forEach((promise, index) => {
        MyPromise.resolve(promise).then(
          value => {
            results[index] = value;
            completedCount++;
            if (completedCount === promises.length) {
              resolve(results);
            }
          },
          reject
        );
      });
    });
  }
  
  static race(promises) {
    return new MyPromise((resolve, reject) => {
      promises.forEach(promise => {
        MyPromise.resolve(promise).then(resolve, reject);
      });
    });
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const promise = new MyPromise((resolve, reject) => {
  setTimeout(() => resolve("Success!"), 1000);
});

promise
  .then(value => {
    console.log(value); // "Success!"
    return value.toUpperCase();
  })
  .then(value => {
    console.log(value); // "SUCCESS!"
  })
  .catch(error => {
    console.error(error);
  });
```

### async/awaitæ·±å…¥

```javascript
// async/awaitçš„æœ¬è´¨æ˜¯Promiseçš„è¯­æ³•ç³–
async function asyncFunction() {
  try {
    const result1 = await fetch('/api/data1');
    const data1 = await result1.json();
    
    const result2 = await fetch(`/api/data2/${data1.id}`);
    const data2 = await result2.json();
    
    return { data1, data2 };
  } catch (error) {
    console.error('Error:', error);
    throw error;
  }
}

// ç­‰ä»·çš„Promiseå†™æ³•
function promiseFunction() {
  return fetch('/api/data1')
    .then(result1 => result1.json())
    .then(data1 => {
      return fetch(`/api/data2/${data1.id}`)
        .then(result2 => result2.json())
        .then(data2 => ({ data1, data2 }));
    })
    .catch(error => {
      console.error('Error:', error);
      throw error;
    });
}

// å¹¶å‘å¤„ç†
async function concurrentRequests() {
  try {
    // ä¸²è¡Œæ‰§è¡Œï¼ˆæ…¢ï¼‰
    const data1 = await fetch('/api/data1');
    const data2 = await fetch('/api/data2');
    
    // å¹¶è¡Œæ‰§è¡Œï¼ˆå¿«ï¼‰
    const [result1, result2] = await Promise.all([
      fetch('/api/data1'),
      fetch('/api/data2')
    ]);
    
    const [data1, data2] = await Promise.all([
      result1.json(),
      result2.json()
    ]);
    
    return { data1, data2 };
  } catch (error) {
    console.error('Error:', error);
  }
}

// é”™è¯¯å¤„ç†æœ€ä½³å®è·µ
class ApiClient {
  constructor(baseURL) {
    this.baseURL = baseURL;
  }
  
  async request(endpoint, options = {}) {
    const url = `${this.baseURL}${endpoint}`;
    const config = {
      headers: {
        'Content-Type': 'application/json',
        ...options.headers
      },
      ...options
    };
    
    try {
      const response = await fetch(url, config);
      
      if (!response.ok) {
        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
      }
      
      return await response.json();
    } catch (error) {
      if (error.name === 'TypeError') {
        throw new Error('Network error: Please check your connection');
      }
      throw error;
    }
  }
  
  async get(endpoint) {
    return this.request(endpoint);
  }
  
  async post(endpoint, data) {
    return this.request(endpoint, {
      method: 'POST',
      body: JSON.stringify(data)
    });
  }
  
  // å¸¦é‡è¯•æœºåˆ¶çš„è¯·æ±‚
  async requestWithRetry(endpoint, options = {}, maxRetries = 3) {
    let lastError;
    
    for (let i = 0; i <= maxRetries; i++) {
      try {
        return await this.request(endpoint, options);
      } catch (error) {
        lastError = error;
        
        if (i < maxRetries) {
          const delay = Math.pow(2, i) * 1000; // æŒ‡æ•°é€€é¿
          await new Promise(resolve => setTimeout(resolve, delay));
        }
      }
    }
    
    throw lastError;
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const api = new ApiClient('https://api.example.com');

async function fetchUserData(userId) {
  try {
    const user = await api.get(`/users/${userId}`);
    const posts = await api.get(`/users/${userId}/posts`);
    
    return { user, posts };
  } catch (error) {
    console.error('Failed to fetch user data:', error.message);
    return null;
  }
}
```

## ES6+æ–°ç‰¹æ€§è¯¦è§£

### è§£æ„èµ‹å€¼å’Œæ‰©å±•è¿ç®—ç¬¦

```javascript
// æ•°ç»„è§£æ„
const [first, second, ...rest] = [1, 2, 3, 4, 5];
console.log(first); // 1
console.log(second); // 2
console.log(rest); // [3, 4, 5]

// é»˜è®¤å€¼
const [a = 10, b = 20] = [1];
console.log(a, b); // 1, 20

// äº¤æ¢å˜é‡
let x = 1, y = 2;
[x, y] = [y, x];
console.log(x, y); // 2, 1

// å¯¹è±¡è§£æ„
const person = { name: 'Alice', age: 30, city: 'New York' };
const { name, age, ...others } = person;
console.log(name, age); // 'Alice', 30
console.log(others); // { city: 'New York' }

// é‡å‘½åå’Œé»˜è®¤å€¼
const { name: personName, age: personAge, country = 'USA' } = person;
console.log(personName, personAge, country); // 'Alice', 30, 'USA'

// åµŒå¥—è§£æ„
const user = {
  id: 1,
  profile: {
    name: 'Bob',
    contact: {
      email: 'bob@example.com'
    }
  }
};

const { profile: { name: userName, contact: { email } } } = user;
console.log(userName, email); // 'Bob', 'bob@example.com'

// å‡½æ•°å‚æ•°è§£æ„
function greet({ name, age = 18 }) {
  return `Hello ${name}, you are ${age} years old`;
}

console.log(greet({ name: 'Charlie' })); // "Hello Charlie, you are 18 years old"

// æ‰©å±•è¿ç®—ç¬¦
const arr1 = [1, 2, 3];
const arr2 = [4, 5, 6];
const combined = [...arr1, ...arr2]; // [1, 2, 3, 4, 5, 6]

const obj1 = { a: 1, b: 2 };
const obj2 = { c: 3, d: 4 };
const merged = { ...obj1, ...obj2 }; // { a: 1, b: 2, c: 3, d: 4 }

// å‡½æ•°å‚æ•°
function sum(...numbers) {
  return numbers.reduce((total, num) => total + num, 0);
}

console.log(sum(1, 2, 3, 4)); // 10
```

### æ¨¡æ¿å­—ç¬¦ä¸²å’Œæ ‡ç­¾æ¨¡æ¿

```javascript
// åŸºç¡€æ¨¡æ¿å­—ç¬¦ä¸²
const name = 'World';
const greeting = `Hello, ${name}!`;
console.log(greeting); // "Hello, World!"

// å¤šè¡Œå­—ç¬¦ä¸²
const multiline = `
  This is a
  multiline
  string
`;

// è¡¨è¾¾å¼è®¡ç®—
const a = 5, b = 10;
console.log(`The sum is ${a + b}`); // "The sum is 15"

// æ ‡ç­¾æ¨¡æ¿
function highlight(strings, ...values) {
  return strings.reduce((result, string, i) => {
    const value = values[i] ? `<mark>${values[i]}</mark>` : '';
    return result + string + value;
  }, '');
}

const searchTerm = 'JavaScript';
const text = highlight`Learn ${searchTerm} programming`;
console.log(text); // "Learn <mark>JavaScript</mark> programming"

// å®ç”¨çš„æ ‡ç­¾æ¨¡æ¿å‡½æ•°
function sql(strings, ...values) {
  // ç®€å•çš„SQLæ³¨å…¥é˜²æŠ¤
  const escapedValues = values.map(value => {
    if (typeof value === 'string') {
      return `'${value.replace(/'/g, "''")}'`;
    }
    return value;
  });
  
  return strings.reduce((query, string, i) => {
    const value = escapedValues[i] || '';
    return query + string + value;
  }, '');
}

const userId = 123;
const userName = "O'Connor";
const query = sql`SELECT * FROM users WHERE id = ${userId} AND name = ${userName}`;
console.log(query); // "SELECT * FROM users WHERE id = 123 AND name = 'O''Connor'"
```

## æ¨¡å—åŒ–å¼€å‘

<Callout type="info">
æ¨¡å—åŒ–æ˜¯ç°ä»£[JavaScript](https://developer.mozilla.org/en-US/docs/Web/JavaScript)å¼€å‘çš„æ ¸å¿ƒæ¦‚å¿µï¼Œå®ƒè®©ä»£ç æ›´åŠ ç»„ç»‡åŒ–ã€å¯ç»´æŠ¤å’Œå¯é‡ç”¨ã€‚
</Callout>

### ES Modules (ESM)

```javascript
// math.js - å¯¼å‡ºæ¨¡å—
export const PI = 3.14159;

export function add(a, b) {
  return a + b;
}

export function multiply(a, b) {
  return a * b;
}

// é»˜è®¤å¯¼å‡º
export default function subtract(a, b) {
  return a - b;
}

// ä¹Ÿå¯ä»¥è¿™æ ·å¯¼å‡º
const divide = (a, b) => a / b;
export { divide };
```

```javascript
// main.js - å¯¼å…¥æ¨¡å—
import subtract, { PI, add, multiply, divide } from './math.js';

// ä½¿ç”¨å¯¼å…¥çš„åŠŸèƒ½
console.log(PI); // 3.14159
console.log(add(5, 3)); // 8
console.log(multiply(4, 2)); // 8
console.log(subtract(10, 3)); // 7
console.log(divide(15, 3)); // 5

// é‡å‘½åå¯¼å…¥
import { add as sum, multiply as product } from './math.js';
console.log(sum(2, 3)); // 5

// å¯¼å…¥æ‰€æœ‰
import * as MathUtils from './math.js';
console.log(MathUtils.add(1, 2)); // 3
console.log(MathUtils.default(5, 2)); // 3 (é»˜è®¤å¯¼å‡º)
```

### CommonJS (Node.js)

```javascript
// math.js - CommonJSå¯¼å‡º
const PI = 3.14159;

function add(a, b) {
  return a + b;
}

function multiply(a, b) {
  return a * b;
}

// å¯¼å‡ºæ–¹å¼1
module.exports = {
  PI,
  add,
  multiply
};

// å¯¼å‡ºæ–¹å¼2
exports.PI = PI;
exports.add = add;
exports.multiply = multiply;

// é»˜è®¤å¯¼å‡º
module.exports = function subtract(a, b) {
  return a - b;
};
```

```javascript
// main.js - CommonJSå¯¼å…¥
const { PI, add, multiply } = require('./math.js');
const subtract = require('./math.js');

// æˆ–è€…
const MathUtils = require('./math.js');
console.log(MathUtils.add(1, 2));
```

### åŠ¨æ€å¯¼å…¥

```javascript
// åŠ¨æ€å¯¼å…¥ESæ¨¡å—
async function loadMathModule() {
  try {
    const mathModule = await import('./math.js');
    console.log(mathModule.add(5, 3)); // 8

    // ä½¿ç”¨é»˜è®¤å¯¼å‡º
    console.log(mathModule.default(10, 3)); // 7
  } catch (error) {
    console.error('æ¨¡å—åŠ è½½å¤±è´¥:', error);
  }
}

// æ¡ä»¶åŠ è½½
if (someCondition) {
  import('./heavy-module.js')
    .then(module => {
      module.doSomething();
    })
    .catch(error => {
      console.error('æ¨¡å—åŠ è½½å¤±è´¥:', error);
    });
}

// åœ¨å‡½æ•°ä¸­åŠ¨æ€å¯¼å…¥
function processData(data) {
  if (data.needsSpecialProcessing) {
    return import('./special-processor.js')
      .then(processor => processor.process(data));
  }
  return Promise.resolve(data);
}
```

### æ¨¡å—æ‰“åŒ…å’Œæ„å»º

```javascript
// webpack.config.js - Webpacké…ç½®ç¤ºä¾‹
const path = require('path');

module.exports = {
  entry: './src/index.js',
  output: {
    filename: 'bundle.js',
    path: path.resolve(__dirname, 'dist')
  },
  module: {
    rules: [
      {
        test: /\.js$/,
        exclude: /node_modules/,
        use: {
          loader: 'babel-loader',
          options: {
            presets: ['@babel/preset-env']
          }
        }
      }
    ]
  },
  resolve: {
    alias: {
      '@': path.resolve(__dirname, 'src'),
      'utils': path.resolve(__dirname, 'src/utils')
    }
  }
};
```

```javascript
// ä½¿ç”¨åˆ«åå¯¼å…¥
import { formatDate } from '@/utils/date.js';
import { apiClient } from 'utils/api.js';
```

### æ¨¡å—è®¾è®¡æ¨¡å¼

```javascript
// å•ä¾‹æ¨¡å¼æ¨¡å—
// config.js
class Config {
  constructor() {
    if (Config.instance) {
      return Config.instance;
    }

    this.settings = {
      apiUrl: 'https://api.example.com',
      timeout: 5000
    };

    Config.instance = this;
  }

  get(key) {
    return this.settings[key];
  }

  set(key, value) {
    this.settings[key] = value;
  }
}

export default new Config();
```

```javascript
// å·¥å‚æ¨¡å¼æ¨¡å—
// logger.js
class Logger {
  constructor(level) {
    this.level = level;
  }

  log(message) {
    if (this.level >= 1) {
      console.log(`[LOG] ${message}`);
    }
  }

  warn(message) {
    if (this.level >= 2) {
      console.warn(`[WARN] ${message}`);
    }
  }

  error(message) {
    if (this.level >= 3) {
      console.error(`[ERROR] ${message}`);
    }
  }
}

export function createLogger(level = 1) {
  return new Logger(level);
}

export const defaultLogger = createLogger(2);
```

---

<Callout type="success">
JavaScriptçš„æ ¸å¿ƒåŸç†å’ŒES6+ç‰¹æ€§ä¸ºç°ä»£Webå¼€å‘æä¾›äº†å¼ºå¤§çš„åŸºç¡€ã€‚æŒæ¡è¿™äº›æ¦‚å¿µèƒ½è®©ä½ å†™å‡ºæ›´ä¼˜é›…ã€æ›´é«˜æ•ˆçš„ä»£ç ã€‚
</Callout>

---

## ğŸ“š å‚è€ƒå­¦ä¹ èµ„æ–™

### ğŸ“– å®˜æ–¹æ–‡æ¡£
- [MDN JavaScript æŒ‡å—](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide) - æœ€æƒå¨çš„JavaScriptå­¦ä¹ èµ„æº
- [ECMAScript è§„èŒƒ](https://tc39.es/ecma262/) - JavaScriptè¯­è¨€è§„èŒƒ
- [V8 å¼€å‘è€…æ–‡æ¡£](https://v8.dev/docs) - V8å¼•æ“å®˜æ–¹æ–‡æ¡£

### ğŸ“ ä¼˜è´¨æ•™ç¨‹
- [JavaScript.info](https://javascript.info/) - ç°ä»£JavaScriptæ•™ç¨‹
- [You Don't Know JS](https://github.com/getify/You-Dont-Know-JS) - æ·±å…¥ç†è§£JavaScriptç³»åˆ—
- [JavaScript 30](https://javascript30.com/) - 30å¤©JavaScriptæŒ‘æˆ˜

### ğŸ› ï¸ å®è·µé¡¹ç›®
- [JavaScript ç®—æ³•ä¸æ•°æ®ç»“æ„](https://github.com/trekhleb/javascript-algorithms) - ç®—æ³•å®ç°
- [33 JS Concepts](https://github.com/leonardomso/33-js-concepts) - æ ¸å¿ƒæ¦‚å¿µå®è·µ
- [Clean Code JavaScript](https://github.com/ryanmcdermott/clean-code-javascript) - ä»£ç è´¨é‡å®è·µ

### ğŸ”§ å¼€å‘å·¥å…·
- [Chrome DevTools](https://developer.chrome.com/docs/devtools/) - æµè§ˆå™¨è°ƒè¯•å·¥å…·
- [Node.js REPL](https://nodejs.org/api/repl.html) - JavaScriptè¿è¡Œç¯å¢ƒ
- [CodePen](https://codepen.io/) - åœ¨çº¿ä»£ç ç¼–è¾‘å™¨

### ğŸ“ æ·±å…¥é˜…è¯»
- [JavaScript å¼•æ“åŸºç¡€](https://mathiasbynens.be/notes/shapes-ics) - å¼•æ“ä¼˜åŒ–åŸç†
- [Event Loop è¯¦è§£](https://blog.sessionstack.com/how-does-javascript-actually-work-part-1-b0bacc073cf) - äº‹ä»¶å¾ªç¯æœºåˆ¶
- [å†…å­˜ç®¡ç†æ·±å…¥](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Memory_Management) - åƒåœ¾å›æ”¶æœºåˆ¶

<Callout type="tip">
ğŸ’¡ **å­¦ä¹ å»ºè®®**ï¼šå»ºè®®å…ˆé€šè¿‡MDNå’ŒJavaScript.infoæŒæ¡åŸºç¡€æ¦‚å¿µï¼Œç„¶åé€šè¿‡å®è·µé¡¹ç›®åŠ æ·±ç†è§£ï¼Œæœ€åé˜…è¯»æ·±åº¦æ–‡ç« äº†è§£åº•å±‚åŸç†ã€‚
</Callout>
