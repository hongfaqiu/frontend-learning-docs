import { Callout } from 'nextra/components'

# 12. å°ç¨‹åºå’Œè·¨ç«¯å¼€å‘

## ğŸ“‹ ç›®å½•

- [å°ç¨‹åºç”Ÿæ€æ¦‚è§ˆ](#å°ç¨‹åºç”Ÿæ€æ¦‚è§ˆ)
- [å¾®ä¿¡å°ç¨‹åºæ·±å…¥å¼€å‘](#å¾®ä¿¡å°ç¨‹åºæ·±å…¥å¼€å‘)
- [è·¨ç«¯æ¡†æ¶å¯¹æ¯”](#è·¨ç«¯æ¡†æ¶å¯¹æ¯”)
- [uni-appå…¨å¹³å°å¼€å‘](#uni-appå…¨å¹³å°å¼€å‘)
- [Taroå¤šç«¯ç»Ÿä¸€å¼€å‘](#taroå¤šç«¯ç»Ÿä¸€å¼€å‘)
- [æ€§èƒ½ä¼˜åŒ–å’Œæœ€ä½³å®è·µ](#æ€§èƒ½ä¼˜åŒ–å’Œæœ€ä½³å®è·µ)

## å°ç¨‹åºç”Ÿæ€æ¦‚è§ˆ

<Callout type="info">
å°ç¨‹åºä½œä¸ºè½»é‡çº§åº”ç”¨å½¢æ€ï¼Œåœ¨ç§»åŠ¨äº’è”ç½‘æ—¶ä»£æ‰®æ¼”ç€é‡è¦è§’è‰²ã€‚ç†è§£å„å¹³å°å°ç¨‹åºçš„ç‰¹ç‚¹å’Œå¼€å‘æ–¹å¼æ˜¯ç°ä»£å‰ç«¯å¼€å‘è€…çš„å¿…å¤‡æŠ€èƒ½ã€‚
</Callout>

### ä¸»æµå°ç¨‹åºå¹³å°å¯¹æ¯”

```javascript
// å°ç¨‹åºå¹³å°ç‰¹æ€§å¯¹æ¯”
const miniProgramPlatforms = {
  // å¾®ä¿¡å°ç¨‹åº
  wechat: {
    name: 'å¾®ä¿¡å°ç¨‹åº',
    userBase: '12äº¿+',
    features: {
      æ”¯ä»˜: 'å¾®ä¿¡æ”¯ä»˜',
      åˆ†äº«: 'æœ‹å‹åœˆã€ç¾¤èŠ',
      ç™»å½•: 'å¾®ä¿¡æˆæƒç™»å½•',
      åœ°å›¾: 'è…¾è®¯åœ°å›¾',
      ç›´æ’­: 'å°ç¨‹åºç›´æ’­',
      äº‘å¼€å‘: 'å¾®ä¿¡äº‘å¼€å‘'
    },
    limitations: {
      åŒ…å¤§å°: 'ä¸»åŒ…2MBï¼Œåˆ†åŒ…20MB',
      åŸŸå: 'éœ€è¦å¤‡æ¡ˆçš„HTTPSåŸŸå',
      å®¡æ ¸: 'è¾ƒä¸¥æ ¼çš„å®¡æ ¸æœºåˆ¶'
    },
    é€‚ç”¨åœºæ™¯: ['ç”µå•†', 'å·¥å…·', 'å†…å®¹', 'æ¸¸æˆ']
  },
  
  // æ”¯ä»˜å®å°ç¨‹åº
  alipay: {
    name: 'æ”¯ä»˜å®å°ç¨‹åº',
    userBase: '10äº¿+',
    features: {
      æ”¯ä»˜: 'æ”¯ä»˜å®æ”¯ä»˜',
      èŠéº»ä¿¡ç”¨: 'ä¿¡ç”¨è¯„ä¼°',
      ç”Ÿæ´»æœåŠ¡: 'åŸå¸‚æœåŠ¡',
      é‡‘èæœåŠ¡: 'ç†è´¢ã€ä¿é™©'
    },
    limitations: {
      åŒ…å¤§å°: 'ä¸»åŒ…2MBï¼Œåˆ†åŒ…8MB',
      ç”Ÿæ€: 'ç›¸å¯¹å°é—­çš„ç”Ÿæ€'
    },
    é€‚ç”¨åœºæ™¯: ['é‡‘è', 'ç”Ÿæ´»æœåŠ¡', 'æ”¿åŠ¡']
  },
  
  // ç™¾åº¦æ™ºèƒ½å°ç¨‹åº
  baidu: {
    name: 'ç™¾åº¦æ™ºèƒ½å°ç¨‹åº',
    userBase: '5äº¿+',
    features: {
      æœç´¢: 'SEOå‹å¥½',
      AIèƒ½åŠ›: 'è¯­éŸ³ã€å›¾åƒè¯†åˆ«',
      å¼€æ”¾ç”Ÿæ€: 'å¯åœ¨å¤šä¸ªAppä¸­è¿è¡Œ'
    },
    é€‚ç”¨åœºæ™¯: ['å†…å®¹', 'å·¥å…·', 'æœåŠ¡']
  },
  
  // å­—èŠ‚è·³åŠ¨å°ç¨‹åº
  bytedance: {
    name: 'å­—èŠ‚è·³åŠ¨å°ç¨‹åº',
    userBase: '6äº¿+',
    features: {
      æµé‡: 'æŠ–éŸ³ã€ä»Šæ—¥å¤´æ¡æµé‡',
      ç®—æ³•æ¨è: 'æ™ºèƒ½æ¨è',
      çŸ­è§†é¢‘: 'è§†é¢‘èƒ½åŠ›'
    },
    é€‚ç”¨åœºæ™¯: ['å†…å®¹', 'å¨±ä¹', 'ç”µå•†']
  }
};

// è·¨ç«¯å¼€å‘æ¡†æ¶å¯¹æ¯”
const crossPlatformFrameworks = {
  'uni-app': {
    å¼€å‘è¯­è¨€: 'Vue.js',
    æ”¯æŒå¹³å°: ['å¾®ä¿¡', 'æ”¯ä»˜å®', 'ç™¾åº¦', 'å­—èŠ‚è·³åŠ¨', 'QQ', 'H5', 'App'],
    å­¦ä¹ æˆæœ¬: 'ä½ï¼ˆVueå¼€å‘è€…ï¼‰',
    æ€§èƒ½: 'æ¥è¿‘åŸç”Ÿ',
    ç”Ÿæ€: 'ä¸°å¯Œçš„æ’ä»¶å¸‚åœº',
    é€‚åˆå›¢é˜Ÿ: 'VueæŠ€æœ¯æ ˆå›¢é˜Ÿ'
  },
  
  'Taro': {
    å¼€å‘è¯­è¨€: 'React/Vue',
    æ”¯æŒå¹³å°: ['å¾®ä¿¡', 'æ”¯ä»˜å®', 'ç™¾åº¦', 'å­—èŠ‚è·³åŠ¨', 'QQ', 'H5', 'RN'],
    å­¦ä¹ æˆæœ¬: 'ä¸­ç­‰',
    æ€§èƒ½: 'è‰¯å¥½',
    ç”Ÿæ€: 'äº¬ä¸œå›¢é˜Ÿç»´æŠ¤',
    é€‚åˆå›¢é˜Ÿ: 'ReactæŠ€æœ¯æ ˆå›¢é˜Ÿ'
  },
  
  'Remax': {
    å¼€å‘è¯­è¨€: 'React',
    æ”¯æŒå¹³å°: ['å¾®ä¿¡', 'æ”¯ä»˜å®', 'å­—èŠ‚è·³åŠ¨'],
    å­¦ä¹ æˆæœ¬: 'ä½ï¼ˆReactå¼€å‘è€…ï¼‰',
    æ€§èƒ½: 'ä¼˜ç§€',
    ç‰¹ç‚¹: 'çœŸæ­£çš„Reactå¼€å‘ä½“éªŒ'
  },
  
  'mpvue': {
    å¼€å‘è¯­è¨€: 'Vue.js',
    æ”¯æŒå¹³å°: ['å¾®ä¿¡', 'æ”¯ä»˜å®', 'ç™¾åº¦'],
    çŠ¶æ€: 'å·²åœæ­¢ç»´æŠ¤',
    æ›¿ä»£æ–¹æ¡ˆ: 'uni-app'
  }
};
```

## å¾®ä¿¡å°ç¨‹åºæ·±å…¥å¼€å‘

### å°ç¨‹åºæ¶æ„å’Œç”Ÿå‘½å‘¨æœŸ

```javascript
// 1. å°ç¨‹åºåº”ç”¨ç”Ÿå‘½å‘¨æœŸ
// app.js
App({
  // å°ç¨‹åºåˆå§‹åŒ–å®Œæˆæ—¶è§¦å‘ï¼Œå…¨å±€åªè§¦å‘ä¸€æ¬¡
  onLaunch(options) {
    console.log('å°ç¨‹åºå¯åŠ¨', options);
    
    // è·å–ç”¨æˆ·ä¿¡æ¯
    this.getUserInfo();
    
    // æ£€æŸ¥æ›´æ–°
    this.checkForUpdate();
    
    // åˆå§‹åŒ–äº‘å¼€å‘
    if (wx.cloud) {
      wx.cloud.init({
        env: 'your-env-id',
        traceUser: true
      });
    }
  },
  
  // å°ç¨‹åºæ˜¾ç¤º/åˆ‡å‰å°æ—¶è§¦å‘
  onShow(options) {
    console.log('å°ç¨‹åºæ˜¾ç¤º', options);
    
    // æ›´æ–°æ•°æ®
    this.updateAppData();
  },
  
  // å°ç¨‹åºéšè—/åˆ‡åå°æ—¶è§¦å‘
  onHide() {
    console.log('å°ç¨‹åºéšè—');
    
    // ä¿å­˜æ•°æ®
    this.saveAppData();
  },
  
  // å°ç¨‹åºå‘ç”Ÿè„šæœ¬é”™è¯¯æˆ–APIè°ƒç”¨æŠ¥é”™æ—¶è§¦å‘
  onError(msg) {
    console.error('å°ç¨‹åºé”™è¯¯', msg);
    
    // é”™è¯¯ä¸ŠæŠ¥
    this.reportError(msg);
  },
  
  // é¡µé¢ä¸å­˜åœ¨æ—¶è§¦å‘
  onPageNotFound(res) {
    console.log('é¡µé¢ä¸å­˜åœ¨', res);
    
    // é‡å®šå‘åˆ°é¦–é¡µ
    wx.redirectTo({
      url: '/pages/index/index'
    });
  },
  
  // å…¨å±€æ•°æ®
  globalData: {
    userInfo: null,
    systemInfo: null
  },
  
  // è·å–ç”¨æˆ·ä¿¡æ¯
  getUserInfo() {
    return new Promise((resolve, reject) => {
      // æ£€æŸ¥æ˜¯å¦å·²æˆæƒ
      wx.getSetting({
        success: (res) => {
          if (res.authSetting['scope.userInfo']) {
            wx.getUserInfo({
              success: (userRes) => {
                this.globalData.userInfo = userRes.userInfo;
                resolve(userRes.userInfo);
              },
              fail: reject
            });
          } else {
            // æœªæˆæƒï¼Œå¼•å¯¼ç”¨æˆ·æˆæƒ
            resolve(null);
          }
        },
        fail: reject
      });
    });
  },
  
  // æ£€æŸ¥å°ç¨‹åºæ›´æ–°
  checkForUpdate() {
    if (wx.canIUse('getUpdateManager')) {
      const updateManager = wx.getUpdateManager();
      
      updateManager.onCheckForUpdate((res) => {
        console.log('æ£€æŸ¥æ›´æ–°ç»“æœ', res.hasUpdate);
      });
      
      updateManager.onUpdateReady(() => {
        wx.showModal({
          title: 'æ›´æ–°æç¤º',
          content: 'æ–°ç‰ˆæœ¬å·²ç»å‡†å¤‡å¥½ï¼Œæ˜¯å¦é‡å¯åº”ç”¨ï¼Ÿ',
          success: (res) => {
            if (res.confirm) {
              updateManager.applyUpdate();
            }
          }
        });
      });
      
      updateManager.onUpdateFailed(() => {
        wx.showToast({
          title: 'æ›´æ–°å¤±è´¥',
          icon: 'none'
        });
      });
    }
  }
});

// 2. é¡µé¢ç”Ÿå‘½å‘¨æœŸ
// pages/index/index.js
Page({
  data: {
    userInfo: {},
    hasUserInfo: false,
    posts: [],
    loading: false
  },
  
  // é¡µé¢åŠ è½½æ—¶è§¦å‘ï¼Œä¸€ä¸ªé¡µé¢åªä¼šè°ƒç”¨ä¸€æ¬¡
  onLoad(options) {
    console.log('é¡µé¢åŠ è½½', options);
    
    // è·å–é¡µé¢å‚æ•°
    this.pageParams = options;
    
    // åˆå§‹åŒ–é¡µé¢æ•°æ®
    this.initPageData();
  },
  
  // é¡µé¢æ˜¾ç¤º/åˆ‡å…¥å‰å°æ—¶è§¦å‘
  onShow() {
    console.log('é¡µé¢æ˜¾ç¤º');
    
    // åˆ·æ–°æ•°æ®
    this.refreshData();
  },
  
  // é¡µé¢éšè—/åˆ‡å…¥åå°æ—¶è§¦å‘
  onHide() {
    console.log('é¡µé¢éšè—');
  },
  
  // é¡µé¢å¸è½½æ—¶è§¦å‘
  onUnload() {
    console.log('é¡µé¢å¸è½½');
    
    // æ¸…ç†å®šæ—¶å™¨
    if (this.timer) {
      clearInterval(this.timer);
    }
  },
  
  // ç›‘å¬ç”¨æˆ·ä¸‹æ‹‰åˆ·æ–°äº‹ä»¶
  onPullDownRefresh() {
    console.log('ä¸‹æ‹‰åˆ·æ–°');
    
    this.refreshData().finally(() => {
      wx.stopPullDownRefresh();
    });
  },
  
  // é¡µé¢ä¸Šæ‹‰è§¦åº•äº‹ä»¶
  onReachBottom() {
    console.log('ä¸Šæ‹‰è§¦åº•');
    
    this.loadMoreData();
  },
  
  // ç”¨æˆ·ç‚¹å‡»å³ä¸Šè§’åˆ†äº«
  onShareAppMessage() {
    return {
      title: 'åˆ†äº«æ ‡é¢˜',
      path: '/pages/index/index',
      imageUrl: '/images/share.jpg'
    };
  },
  
  // ç”¨æˆ·ç‚¹å‡»å³ä¸Šè§’åˆ†äº«åˆ°æœ‹å‹åœˆ
  onShareTimeline() {
    return {
      title: 'åˆ†äº«åˆ°æœ‹å‹åœˆçš„æ ‡é¢˜',
      query: 'from=timeline',
      imageUrl: '/images/timeline-share.jpg'
    };
  },
  
  // åˆå§‹åŒ–é¡µé¢æ•°æ®
  async initPageData() {
    try {
      this.setData({ loading: true });
      
      // è·å–ç”¨æˆ·ä¿¡æ¯
      const app = getApp();
      if (app.globalData.userInfo) {
        this.setData({
          userInfo: app.globalData.userInfo,
          hasUserInfo: true
        });
      }
      
      // åŠ è½½æ–‡ç« åˆ—è¡¨
      await this.loadPosts();
      
    } catch (error) {
      console.error('åˆå§‹åŒ–å¤±è´¥', error);
      wx.showToast({
        title: 'åŠ è½½å¤±è´¥',
        icon: 'none'
      });
    } finally {
      this.setData({ loading: false });
    }
  },
  
  // åŠ è½½æ–‡ç« åˆ—è¡¨
  async loadPosts() {
    try {
      const res = await wx.cloud.callFunction({
        name: 'getPosts',
        data: {
          page: 1,
          limit: 10
        }
      });
      
      this.setData({
        posts: res.result.data
      });
    } catch (error) {
      console.error('åŠ è½½æ–‡ç« å¤±è´¥', error);
    }
  },
  
  // åˆ·æ–°æ•°æ®
  async refreshData() {
    await this.loadPosts();
  },
  
  // åŠ è½½æ›´å¤šæ•°æ®
  async loadMoreData() {
    // å®ç°åˆ†é¡µåŠ è½½é€»è¾‘
  },
  
  // è·å–ç”¨æˆ·ä¿¡æ¯æŒ‰é’®ç‚¹å‡»äº‹ä»¶
  getUserProfile(e) {
    wx.getUserProfile({
      desc: 'ç”¨äºå®Œå–„ä¼šå‘˜èµ„æ–™',
      success: (res) => {
        this.setData({
          userInfo: res.userInfo,
          hasUserInfo: true
        });
        
        // ä¿å­˜åˆ°å…¨å±€æ•°æ®
        getApp().globalData.userInfo = res.userInfo;
      }
    });
  }
});
```

### å°ç¨‹åºäº‘å¼€å‘

```javascript
// 1. äº‘å‡½æ•°å¼€å‘
// cloudfunctions/getPosts/index.js
const cloud = require('wx-server-sdk');

cloud.init({
  env: cloud.DYNAMIC_CURRENT_ENV
});

const db = cloud.database();

exports.main = async (event, context) => {
  const { page = 1, limit = 10, category } = event;
  
  try {
    // æ„å»ºæŸ¥è¯¢æ¡ä»¶
    let query = db.collection('posts');
    
    if (category) {
      query = query.where({
        category: category,
        status: 'published'
      });
    } else {
      query = query.where({
        status: 'published'
      });
    }
    
    // åˆ†é¡µæŸ¥è¯¢
    const result = await query
      .orderBy('createdAt', 'desc')
      .skip((page - 1) * limit)
      .limit(limit)
      .get();
    
    // è·å–æ€»æ•°
    const countResult = await query.count();
    
    return {
      code: 0,
      data: result.data,
      total: countResult.total,
      page,
      limit
    };
  } catch (error) {
    console.error('è·å–æ–‡ç« å¤±è´¥', error);
    return {
      code: -1,
      message: 'è·å–æ–‡ç« å¤±è´¥'
    };
  }
};

// 2. äº‘æ•°æ®åº“æ“ä½œ
class CloudDatabase {
  constructor() {
    this.db = wx.cloud.database();
  }
  
  // æ·»åŠ æ–‡æ¡£
  async add(collection, data) {
    try {
      const result = await this.db.collection(collection).add({
        data: {
          ...data,
          createdAt: new Date(),
          updatedAt: new Date()
        }
      });
      
      return {
        success: true,
        id: result._id
      };
    } catch (error) {
      console.error('æ·»åŠ æ–‡æ¡£å¤±è´¥', error);
      return {
        success: false,
        error: error.message
      };
    }
  }
  
  // æŸ¥è¯¢æ–‡æ¡£
  async get(collection, id) {
    try {
      const result = await this.db.collection(collection).doc(id).get();
      return {
        success: true,
        data: result.data
      };
    } catch (error) {
      console.error('æŸ¥è¯¢æ–‡æ¡£å¤±è´¥', error);
      return {
        success: false,
        error: error.message
      };
    }
  }
  
  // æ›´æ–°æ–‡æ¡£
  async update(collection, id, data) {
    try {
      await this.db.collection(collection).doc(id).update({
        data: {
          ...data,
          updatedAt: new Date()
        }
      });
      
      return { success: true };
    } catch (error) {
      console.error('æ›´æ–°æ–‡æ¡£å¤±è´¥', error);
      return {
        success: false,
        error: error.message
      };
    }
  }
  
  // åˆ é™¤æ–‡æ¡£
  async remove(collection, id) {
    try {
      await this.db.collection(collection).doc(id).remove();
      return { success: true };
    } catch (error) {
      console.error('åˆ é™¤æ–‡æ¡£å¤±è´¥', error);
      return {
        success: false,
        error: error.message
      };
    }
  }
  
  // å¤æ‚æŸ¥è¯¢
  async query(collection, conditions = {}) {
    try {
      let query = this.db.collection(collection);
      
      // æ·»åŠ æŸ¥è¯¢æ¡ä»¶
      if (Object.keys(conditions).length > 0) {
        query = query.where(conditions);
      }
      
      const result = await query.get();
      
      return {
        success: true,
        data: result.data
      };
    } catch (error) {
      console.error('æŸ¥è¯¢å¤±è´¥', error);
      return {
        success: false,
        error: error.message
      };
    }
  }
}

// 3. äº‘å­˜å‚¨æ“ä½œ
class CloudStorage {
  // ä¸Šä¼ æ–‡ä»¶
  async uploadFile(filePath, cloudPath) {
    try {
      const result = await wx.cloud.uploadFile({
        cloudPath,
        filePath
      });
      
      return {
        success: true,
        fileID: result.fileID
      };
    } catch (error) {
      console.error('ä¸Šä¼ æ–‡ä»¶å¤±è´¥', error);
      return {
        success: false,
        error: error.message
      };
    }
  }
  
  // ä¸‹è½½æ–‡ä»¶
  async downloadFile(fileID) {
    try {
      const result = await wx.cloud.downloadFile({
        fileID
      });
      
      return {
        success: true,
        tempFilePath: result.tempFilePath
      };
    } catch (error) {
      console.error('ä¸‹è½½æ–‡ä»¶å¤±è´¥', error);
      return {
        success: false,
        error: error.message
      };
    }
  }
  
  // åˆ é™¤æ–‡ä»¶
  async deleteFile(fileIDs) {
    try {
      const result = await wx.cloud.deleteFile({
        fileList: Array.isArray(fileIDs) ? fileIDs : [fileIDs]
      });
      
      return {
        success: true,
        deleteList: result.fileList
      };
    } catch (error) {
      console.error('åˆ é™¤æ–‡ä»¶å¤±è´¥', error);
      return {
        success: false,
        error: error.message
      };
    }
  }
  
  // è·å–ä¸´æ—¶é“¾æ¥
  async getTempFileURL(fileIDs) {
    try {
      const result = await wx.cloud.getTempFileURL({
        fileList: Array.isArray(fileIDs) 
          ? fileIDs.map(id => ({ fileID: id }))
          : [{ fileID: fileIDs }]
      });
      
      return {
        success: true,
        fileList: result.fileList
      };
    } catch (error) {
      console.error('è·å–ä¸´æ—¶é“¾æ¥å¤±è´¥', error);
      return {
        success: false,
        error: error.message
      };
    }
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const cloudDB = new CloudDatabase();
const cloudStorage = new CloudStorage();

// åœ¨é¡µé¢ä¸­ä½¿ç”¨
Page({
  data: {
    imageUrl: ''
  },
  
  // é€‰æ‹©å¹¶ä¸Šä¼ å›¾ç‰‡
  async chooseAndUploadImage() {
    try {
      // é€‰æ‹©å›¾ç‰‡
      const chooseResult = await wx.chooseImage({
        count: 1,
        sizeType: ['compressed'],
        sourceType: ['album', 'camera']
      });
      
      const tempFilePath = chooseResult.tempFilePaths[0];
      
      // ä¸Šä¼ åˆ°äº‘å­˜å‚¨
      const uploadResult = await cloudStorage.uploadFile(
        tempFilePath,
        `images/${Date.now()}.jpg`
      );
      
      if (uploadResult.success) {
        // è·å–ä¸´æ—¶é“¾æ¥ç”¨äºæ˜¾ç¤º
        const urlResult = await cloudStorage.getTempFileURL(uploadResult.fileID);
        
        if (urlResult.success) {
          this.setData({
            imageUrl: urlResult.fileList[0].tempFileURL
          });
        }
      }
    } catch (error) {
      console.error('ä¸Šä¼ å›¾ç‰‡å¤±è´¥', error);
      wx.showToast({
        title: 'ä¸Šä¼ å¤±è´¥',
        icon: 'none'
      });
    }
  }
});
```

## è·¨ç«¯æ¡†æ¶å¯¹æ¯”

<Callout type="info">
è·¨ç«¯å¼€å‘æ¡†æ¶è®©å¼€å‘è€…èƒ½å¤Ÿç”¨ä¸€å¥—ä»£ç è¿è¡Œåœ¨å¤šä¸ªå¹³å°ä¸Šï¼Œå¤§å¤§æå‡äº†å¼€å‘æ•ˆç‡ã€‚
</Callout>

### ä¸»æµè·¨ç«¯æ¡†æ¶å¯¹æ¯”

```javascript
// è·¨ç«¯æ¡†æ¶ç‰¹æ€§å¯¹æ¯”
const crossPlatformFrameworks = {
  'uni-app': {
    æŠ€æœ¯æ ˆ: 'Vue.js',
    å¼€å‘è¯­è¨€: 'Vue + JavaScript/TypeScript',
    æ”¯æŒå¹³å°: [
      'å¾®ä¿¡å°ç¨‹åº', 'æ”¯ä»˜å®å°ç¨‹åº', 'ç™¾åº¦å°ç¨‹åº',
      'å­—èŠ‚è·³åŠ¨å°ç¨‹åº', 'QQå°ç¨‹åº', 'H5',
      'Android App', 'iOS App'
    ],
    ä¼˜åŠ¿: [
      'å­¦ä¹ æˆæœ¬ä½ï¼ˆVueå¼€å‘è€…ï¼‰',
      'å¹³å°æ”¯æŒæœ€å…¨é¢',
      'ä¸°å¯Œçš„æ’ä»¶å¸‚åœº',
      'æ´»è·ƒçš„ç¤¾åŒºæ”¯æŒ'
    ],
    åŠ£åŠ¿: [
      'éƒ¨åˆ†å¹³å°ç‰¹æ€§æ”¯æŒæœ‰é™',
      'æ€§èƒ½ä¸å¦‚åŸç”Ÿå¼€å‘',
      'è°ƒè¯•ç›¸å¯¹å¤æ‚'
    ],
    é€‚ç”¨åœºæ™¯: 'ä¸­å°å‹åº”ç”¨ï¼Œå¿«é€Ÿå¤šç«¯éƒ¨ç½²',
    å¸‚åœºå æœ‰ç‡: '40%+'
  },

  'Taro': {
    æŠ€æœ¯æ ˆ: 'React/Vue',
    å¼€å‘è¯­è¨€: 'React/Vue + JavaScript/TypeScript',
    æ”¯æŒå¹³å°: [
      'å¾®ä¿¡å°ç¨‹åº', 'æ”¯ä»˜å®å°ç¨‹åº', 'ç™¾åº¦å°ç¨‹åº',
      'å­—èŠ‚è·³åŠ¨å°ç¨‹åº', 'QQå°ç¨‹åº', 'H5',
      'React Native', 'Flutter'
    ],
    ä¼˜åŠ¿: [
      'æ”¯æŒReactå’ŒVue',
      'äº¬ä¸œå›¢é˜Ÿç»´æŠ¤',
      'ç¼–è¯‘æ—¶ä¼˜åŒ–',
      'ç±»å‹å®‰å…¨æ”¯æŒ'
    ],
    åŠ£åŠ¿: [
      'å­¦ä¹ æ›²çº¿ç›¸å¯¹é™¡å³­',
      'ç¼–è¯‘äº§ç‰©è¾ƒå¤§',
      'éƒ¨åˆ†APIå…¼å®¹æ€§é—®é¢˜'
    ],
    é€‚ç”¨åœºæ™¯: 'å¤§å‹åº”ç”¨ï¼ŒReact/VueæŠ€æœ¯æ ˆå›¢é˜Ÿ',
    å¸‚åœºå æœ‰ç‡: '25%+'
  },

  'Flutter': {
    æŠ€æœ¯æ ˆ: 'Flutter + Dart',
    å¼€å‘è¯­è¨€: 'Dart',
    æ”¯æŒå¹³å°: [
      'Android App', 'iOS App', 'Web',
      'Windows', 'macOS', 'Linux'
    ],
    ä¼˜åŠ¿: [
      'é«˜æ€§èƒ½æ¸²æŸ“',
      'ä¸€è‡´çš„UIä½“éªŒ',
      'Googleå®˜æ–¹æ”¯æŒ',
      'çƒ­é‡è½½å¼€å‘ä½“éªŒ'
    ],
    åŠ£åŠ¿: [
      'å­¦ä¹ æˆæœ¬é«˜',
      'åº”ç”¨ä½“ç§¯è¾ƒå¤§',
      'å°ç¨‹åºæ”¯æŒæœ‰é™'
    ],
    é€‚ç”¨åœºæ™¯: 'é«˜æ€§èƒ½åº”ç”¨ï¼Œè·¨å¹³å°ä¸€è‡´æ€§è¦æ±‚é«˜',
    å¸‚åœºå æœ‰ç‡: '20%+'
  },

  'React Native': {
    æŠ€æœ¯æ ˆ: 'React + JavaScript',
    å¼€å‘è¯­è¨€: 'JavaScript/TypeScript',
    æ”¯æŒå¹³å°: [
      'Android App', 'iOS App', 'Web'
    ],
    ä¼˜åŠ¿: [
      'Facebookå®˜æ–¹æ”¯æŒ',
      'åŸç”Ÿæ€§èƒ½',
      'ä¸°å¯Œçš„ç¬¬ä¸‰æ–¹åº“',
      'Reactå¼€å‘è€…å‹å¥½'
    ],
    åŠ£åŠ¿: [
      'ä¸æ”¯æŒå°ç¨‹åº',
      'å¹³å°å·®å¼‚å¤„ç†å¤æ‚',
      'å‡çº§æˆæœ¬é«˜'
    ],
    é€‚ç”¨åœºæ™¯: 'Appå¼€å‘ï¼ŒReactæŠ€æœ¯æ ˆ',
    å¸‚åœºå æœ‰ç‡: '15%+'
  }
};

// æ¡†æ¶é€‰æ‹©å†³ç­–æ ‘
function chooseFramework(requirements) {
  const {
    targetPlatforms,
    teamSkills,
    performanceRequirements,
    developmentTime,
    maintenanceBudget
  } = requirements;

  // éœ€è¦å°ç¨‹åºæ”¯æŒ
  if (targetPlatforms.includes('miniprogram')) {
    if (teamSkills.includes('vue')) {
      return {
        recommendation: 'uni-app',
        reason: 'VueæŠ€æœ¯æ ˆ + æœ€å…¨é¢çš„å°ç¨‹åºæ”¯æŒ'
      };
    } else if (teamSkills.includes('react')) {
      return {
        recommendation: 'Taro',
        reason: 'ReactæŠ€æœ¯æ ˆ + è‰¯å¥½çš„å°ç¨‹åºæ”¯æŒ'
      };
    }
  }

  // ä¸»è¦åšAppå¼€å‘
  if (targetPlatforms.every(p => ['ios', 'android', 'web'].includes(p))) {
    if (performanceRequirements === 'high') {
      return {
        recommendation: 'Flutter',
        reason: 'é«˜æ€§èƒ½ + ä¸€è‡´çš„UIä½“éªŒ'
      };
    } else if (teamSkills.includes('react')) {
      return {
        recommendation: 'React Native',
        reason: 'ReactæŠ€æœ¯æ ˆ + åŸç”Ÿæ€§èƒ½'
      };
    }
  }

  // å¿«é€Ÿå¼€å‘éœ€æ±‚
  if (developmentTime === 'short') {
    return {
      recommendation: 'uni-app',
      reason: 'å¼€å‘æ•ˆç‡é«˜ + å¹³å°è¦†ç›–å¹¿'
    };
  }

  return {
    recommendation: 'uni-app',
    reason: 'ç»¼åˆè€ƒè™‘æœ€ä½³é€‰æ‹©'
  };
}
```

## uni-appå…¨å¹³å°å¼€å‘

### uni-appé¡¹ç›®ç»“æ„å’Œé…ç½®

```javascript
// 1. é¡¹ç›®é…ç½® - manifest.json
{
  "name": "uni-app-demo",
  "appid": "__UNI__XXXXXXX",
  "description": "uni-appè·¨å¹³å°åº”ç”¨",
  "versionName": "1.0.0",
  "versionCode": "100",
  "transformPx": false,
  "app-plus": {
    "usingComponents": true,
    "nvueStyleCompiler": "uni-app",
    "compilerVersion": 3,
    "splashscreen": {
      "alwaysShowBeforeRender": true,
      "waiting": true,
      "autoclose": true,
      "delay": 0
    },
    "modules": {},
    "distribute": {
      "android": {
        "permissions": [
          "<uses-permission android:name=\"android.permission.CHANGE_NETWORK_STATE\" />",
          "<uses-permission android:name=\"android.permission.MOUNT_UNMOUNT_FILESYSTEMS\" />",
          "<uses-permission android:name=\"android.permission.VIBRATE\" />",
          "<uses-permission android:name=\"android.permission.READ_LOGS\" />",
          "<uses-permission android:name=\"android.permission.ACCESS_WIFI_STATE\" />",
          "<uses-feature android:name=\"android.hardware.camera.autofocus\" />",
          "<uses-permission android:name=\"android.permission.ACCESS_NETWORK_STATE\" />",
          "<uses-permission android:name=\"android.permission.CAMERA\" />",
          "<uses-permission android:name=\"android.permission.GET_ACCOUNTS\" />",
          "<uses-permission android:name=\"android.permission.READ_PHONE_STATE\" />",
          "<uses-permission android:name=\"android.permission.CHANGE_WIFI_STATE\" />",
          "<uses-permission android:name=\"android.permission.WAKE_LOCK\" />",
          "<uses-permission android:name=\"android.permission.FLASHLIGHT\" />",
          "<uses-permission android:name=\"android.permission.WRITE_SETTINGS\" />"
        ]
      },
      "ios": {},
      "sdkConfigs": {
        "ad": {},
        "oauth": {},
        "payment": {},
        "push": {},
        "share": {},
        "statics": {}
      }
    }
  },
  "quickapp": {},
  "mp-weixin": {
    "appid": "wxXXXXXXXXXXXXXXXX",
    "setting": {
      "urlCheck": false
    },
    "usingComponents": true
  },
  "mp-alipay": {
    "usingComponents": true
  },
  "mp-baidu": {
    "usingComponents": true
  },
  "mp-toutiao": {
    "usingComponents": true
  },
  "uniStatistics": {
    "enable": false
  },
  "vueVersion": "3"
}

// 2. é¡µé¢é…ç½® - pages.json
{
  "pages": [
    {
      "path": "pages/index/index",
      "style": {
        "navigationBarTitleText": "é¦–é¡µ"
      }
    },
    {
      "path": "pages/list/list",
      "style": {
        "navigationBarTitleText": "åˆ—è¡¨é¡µ",
        "enablePullDownRefresh": true
      }
    },
    {
      "path": "pages/detail/detail",
      "style": {
        "navigationBarTitleText": "è¯¦æƒ…é¡µ"
      }
    }
  ],
  "globalStyle": {
    "navigationBarTextStyle": "black",
    "navigationBarTitleText": "uni-app",
    "navigationBarBackgroundColor": "#F8F8F8",
    "backgroundColor": "#F8F8F8"
  },
  "tabBar": {
    "color": "#7A7E83",
    "selectedColor": "#3cc51f",
    "borderStyle": "black",
    "backgroundColor": "#ffffff",
    "list": [
      {
        "pagePath": "pages/index/index",
        "iconPath": "static/tab-home.png",
        "selectedIconPath": "static/tab-home-current.png",
        "text": "é¦–é¡µ"
      },
      {
        "pagePath": "pages/list/list",
        "iconPath": "static/tab-list.png",
        "selectedIconPath": "static/tab-list-current.png",
        "text": "åˆ—è¡¨"
      }
    ]
  }
}
```

### uni-appç»„ä»¶å¼€å‘

```vue
<!-- 3. è‡ªå®šä¹‰ç»„ä»¶å¼€å‘ -->
<!-- components/custom-list/custom-list.vue -->
<template>
  <view class="custom-list">
    <view class="list-header" v-if="title">
      <text class="header-title">{{ title }}</text>
      <view class="header-action" @click="onHeaderAction">
        <text class="action-text">{{ actionText }}</text>
      </view>
    </view>

    <scroll-view
      class="list-content"
      scroll-y="true"
      @scrolltolower="onLoadMore"
      :refresher-enabled="enableRefresh"
      :refresher-triggered="refreshing"
      @refresherrefresh="onRefresh"
    >
      <view
        class="list-item"
        v-for="(item, index) in list"
        :key="item.id || index"
        @click="onItemClick(item, index)"
      >
        <slot name="item" :item="item" :index="index">
          <!-- é»˜è®¤åˆ—è¡¨é¡¹ -->
          <view class="default-item">
            <image
              v-if="item.image"
              class="item-image"
              :src="item.image"
              mode="aspectFill"
            />
            <view class="item-content">
              <text class="item-title">{{ item.title }}</text>
              <text class="item-desc">{{ item.description }}</text>
            </view>
          </view>
        </slot>
      </view>

      <!-- åŠ è½½æ›´å¤š -->
      <view class="load-more" v-if="showLoadMore">
        <uni-load-more :status="loadMoreStatus"></uni-load-more>
      </view>
    </scroll-view>
  </view>
</template>

<script>
export default {
  name: 'CustomList',
  props: {
    title: {
      type: String,
      default: ''
    },
    actionText: {
      type: String,
      default: 'æ›´å¤š'
    },
    list: {
      type: Array,
      default: () => []
    },
    enableRefresh: {
      type: Boolean,
      default: true
    },
    showLoadMore: {
      type: Boolean,
      default: true
    }
  },
  data() {
    return {
      refreshing: false,
      loadMoreStatus: 'more' // more, loading, noMore
    };
  },
  methods: {
    onHeaderAction() {
      this.$emit('header-action');
    },

    onItemClick(item, index) {
      this.$emit('item-click', { item, index });
    },

    async onRefresh() {
      this.refreshing = true;
      try {
        await this.$emit('refresh');
      } finally {
        this.refreshing = false;
      }
    },

    async onLoadMore() {
      if (this.loadMoreStatus !== 'more') return;

      this.loadMoreStatus = 'loading';
      try {
        const hasMore = await this.$emit('load-more');
        this.loadMoreStatus = hasMore ? 'more' : 'noMore';
      } catch (error) {
        this.loadMoreStatus = 'more';
        uni.showToast({
          title: 'åŠ è½½å¤±è´¥',
          icon: 'none'
        });
      }
    }
  }
};
</script>

<style lang="scss" scoped>
.custom-list {
  height: 100%;
  display: flex;
  flex-direction: column;
}

.list-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20rpx 30rpx;
  background-color: #fff;
  border-bottom: 1rpx solid #eee;

  .header-title {
    font-size: 32rpx;
    font-weight: bold;
    color: #333;
  }

  .header-action {
    .action-text {
      font-size: 28rpx;
      color: #007aff;
    }
  }
}

.list-content {
  flex: 1;
  background-color: #f5f5f5;
}

.list-item {
  margin: 20rpx;
  background-color: #fff;
  border-radius: 12rpx;
  overflow: hidden;
}

.default-item {
  display: flex;
  padding: 30rpx;

  .item-image {
    width: 120rpx;
    height: 120rpx;
    border-radius: 8rpx;
    margin-right: 20rpx;
  }

  .item-content {
    flex: 1;

    .item-title {
      font-size: 32rpx;
      color: #333;
      margin-bottom: 10rpx;
      display: block;
    }

    .item-desc {
      font-size: 28rpx;
      color: #666;
      display: block;
    }
  }
}

.load-more {
  padding: 30rpx;
}
</style>

<!-- 4. é¡µé¢ä½¿ç”¨ç»„ä»¶ -->
<!-- pages/list/list.vue -->
<template>
  <view class="page">
    <custom-list
      title="æ–‡ç« åˆ—è¡¨"
      action-text="æœç´¢"
      :list="articleList"
      @header-action="onSearch"
      @item-click="onArticleClick"
      @refresh="onRefresh"
      @load-more="onLoadMore"
    >
      <template #item="{ item, index }">
        <view class="article-item">
          <image class="article-cover" :src="item.cover" mode="aspectFill" />
          <view class="article-info">
            <text class="article-title">{{ item.title }}</text>
            <text class="article-summary">{{ item.summary }}</text>
            <view class="article-meta">
              <text class="meta-author">{{ item.author }}</text>
              <text class="meta-time">{{ formatTime(item.publishTime) }}</text>
              <text class="meta-views">{{ item.views }}é˜…è¯»</text>
            </view>
          </view>
        </view>
      </template>
    </custom-list>
  </view>
</template>

<script>
import CustomList from '@/components/custom-list/custom-list.vue';

export default {
  components: {
    CustomList
  },
  data() {
    return {
      articleList: [],
      page: 1,
      pageSize: 10,
      hasMore: true
    };
  },
  onLoad() {
    this.loadArticles();
  },
  methods: {
    async loadArticles(refresh = false) {
      if (refresh) {
        this.page = 1;
        this.hasMore = true;
      }

      try {
        const response = await uni.request({
          url: '/api/articles',
          data: {
            page: this.page,
            pageSize: this.pageSize
          }
        });

        const { data } = response[1];

        if (refresh) {
          this.articleList = data.list;
        } else {
          this.articleList.push(...data.list);
        }

        this.hasMore = data.hasMore;
        this.page++;

        return this.hasMore;
      } catch (error) {
        console.error('åŠ è½½æ–‡ç« å¤±è´¥:', error);
        uni.showToast({
          title: 'åŠ è½½å¤±è´¥',
          icon: 'none'
        });
        return false;
      }
    },

    onSearch() {
      uni.navigateTo({
        url: '/pages/search/search'
      });
    },

    onArticleClick({ item }) {
      uni.navigateTo({
        url: `/pages/article/article?id=${item.id}`
      });
    },

    async onRefresh() {
      await this.loadArticles(true);
    },

    async onLoadMore() {
      if (!this.hasMore) return false;
      return await this.loadArticles();
    },

    formatTime(timestamp) {
      const date = new Date(timestamp);
      const now = new Date();
      const diff = now - date;

      if (diff < 60000) return 'åˆšåˆš';
      if (diff < 3600000) return `${Math.floor(diff / 60000)}åˆ†é’Ÿå‰`;
      if (diff < 86400000) return `${Math.floor(diff / 3600000)}å°æ—¶å‰`;
      return `${Math.floor(diff / 86400000)}å¤©å‰`;
    }
  }
};
</script>

<style lang="scss" scoped>
.page {
  height: 100vh;
}

.article-item {
  display: flex;
  padding: 30rpx;

  .article-cover {
    width: 200rpx;
    height: 150rpx;
    border-radius: 8rpx;
    margin-right: 20rpx;
  }

  .article-info {
    flex: 1;

    .article-title {
      font-size: 32rpx;
      color: #333;
      font-weight: bold;
      margin-bottom: 15rpx;
      display: block;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .article-summary {
      font-size: 28rpx;
      color: #666;
      margin-bottom: 20rpx;
      display: block;
      overflow: hidden;
      text-overflow: ellipsis;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
    }

    .article-meta {
      display: flex;
      font-size: 24rpx;
      color: #999;

      .meta-author,
      .meta-time,
      .meta-views {
        margin-right: 20rpx;
      }
    }
  }
}
</style>
```

## Taroå¤šç«¯ç»Ÿä¸€å¼€å‘

<Callout type="info">
[Taro](https://taro.jd.com/)æ˜¯äº¬ä¸œå¼€æºçš„å¤šç«¯ç»Ÿä¸€å¼€å‘æ¡†æ¶ï¼Œæ”¯æŒReactå’ŒVueè¯­æ³•ï¼Œèƒ½å¤Ÿç¼–è¯‘åˆ°å¤šä¸ªå¹³å°ã€‚
</Callout>

### Taroé¡¹ç›®é…ç½®

```javascript
// 1. é¡¹ç›®é…ç½® - config/index.js
const config = {
  projectName: 'taro-app',
  date: '2023-12-1',
  designWidth: 750,
  deviceRatio: {
    640: 2.34 / 2,
    750: 1,
    828: 1.81 / 2
  },
  sourceRoot: 'src',
  outputRoot: 'dist',
  plugins: [],
  defineConstants: {
    API_BASE_URL: JSON.stringify('https://api.example.com')
  },
  copy: {
    patterns: [
    ],
    options: {
    }
  },
  framework: 'react',
  compiler: 'webpack5',
  cache: {
    enable: false // Webpack æŒä¹…åŒ–ç¼“å­˜é…ç½®ï¼Œå»ºè®®å¼€å¯ã€‚é»˜è®¤é…ç½®è¯·å‚è€ƒï¼šhttps://docs.taro.zone/docs/config-detail#cache
  },
  mini: {
    postcss: {
      pxtransform: {
        enable: true,
        config: {

        }
      },
      url: {
        enable: true,
        config: {
          limit: 1024 // è®¾å®šè½¬æ¢å°ºå¯¸ä¸Šé™
        }
      },
      cssModules: {
        enable: false, // é»˜è®¤ä¸º falseï¼Œå¦‚éœ€ä½¿ç”¨ css modules åŠŸèƒ½ï¼Œåˆ™è®¾ä¸º true
        config: {
          namingPattern: 'module', // è½¬æ¢æ¨¡å¼ï¼Œå–å€¼ä¸º global/module
          generateScopedName: '[name]__[local]___[hash:base64:5]'
        }
      }
    }
  },
  h5: {
    publicPath: '/',
    staticDirectory: 'static',
    esnextModules: ['taro-ui'],
    postcss: {
      autoprefixer: {
        enable: true,
        config: {
        }
      },
      cssModules: {
        enable: false, // é»˜è®¤ä¸º falseï¼Œå¦‚éœ€ä½¿ç”¨ css modules åŠŸèƒ½ï¼Œåˆ™è®¾ä¸º true
        config: {
          namingPattern: 'module', // è½¬æ¢æ¨¡å¼ï¼Œå–å€¼ä¸º global/module
          generateScopedName: '[name]__[local]___[hash:base64:5]'
        }
      }
    }
  },
  rn: {
    appName: 'taroDemo',
    postcss: {
      cssModules: {
        enable: false, // é»˜è®¤ä¸º falseï¼Œå¦‚éœ€ä½¿ç”¨ css modules åŠŸèƒ½ï¼Œåˆ™è®¾ä¸º true
      }
    }
  }
}

module.exports = function (merge) {
  if (process.env.NODE_ENV === 'development') {
    return merge({}, config, require('./dev'))
  }
  return merge({}, config, require('./prod'))
}

// 2. Taro Reactç»„ä»¶å¼€å‘
// src/components/ProductCard/index.tsx
import React, { useState } from 'react';
import { View, Image, Text, Button } from '@tarojs/components';
import { navigateTo, showToast } from '@tarojs/taro';
import './index.scss';

interface Product {
  id: string;
  name: string;
  price: number;
  originalPrice?: number;
  image: string;
  description: string;
  stock: number;
}

interface ProductCardProps {
  product: Product;
  onAddToCart?: (product: Product) => void;
}

const ProductCard: React.FC<ProductCardProps> = ({ product, onAddToCart }) => {
  const [loading, setLoading] = useState(false);

  const handleAddToCart = async () => {
    if (product.stock <= 0) {
      showToast({
        title: 'å•†å“å·²å”®ç½„',
        icon: 'none'
      });
      return;
    }

    setLoading(true);
    try {
      await onAddToCart?.(product);
      showToast({
        title: 'å·²åŠ å…¥è´­ç‰©è½¦',
        icon: 'success'
      });
    } catch (error) {
      showToast({
        title: 'åŠ å…¥è´­ç‰©è½¦å¤±è´¥',
        icon: 'none'
      });
    } finally {
      setLoading(false);
    }
  };

  const handleViewDetail = () => {
    navigateTo({
      url: `/pages/product/detail?id=${product.id}`
    });
  };

  return (
    <View className="product-card">
      <View className="product-image-container" onClick={handleViewDetail}>
        <Image
          className="product-image"
          src={product.image}
          mode="aspectFill"
        />
        {product.stock <= 0 && (
          <View className="sold-out-mask">
            <Text className="sold-out-text">å”®ç½„</Text>
          </View>
        )}
      </View>

      <View className="product-info">
        <Text className="product-name" onClick={handleViewDetail}>
          {product.name}
        </Text>
        <Text className="product-desc">{product.description}</Text>

        <View className="price-container">
          <Text className="current-price">Â¥{product.price}</Text>
          {product.originalPrice && product.originalPrice > product.price && (
            <Text className="original-price">Â¥{product.originalPrice}</Text>
          )}
        </View>

        <View className="action-container">
          <Text className="stock-info">åº“å­˜: {product.stock}</Text>
          <Button
            className="add-cart-btn"
            size="mini"
            type="primary"
            loading={loading}
            disabled={product.stock <= 0}
            onClick={handleAddToCart}
          >
            {product.stock <= 0 ? 'å”®ç½„' : 'åŠ è´­ç‰©è½¦'}
          </Button>
        </View>
      </View>
    </View>
  );
};

export default ProductCard;

// 3. Taro Hooksä½¿ç”¨
// src/hooks/useRequest.ts
import { useState, useEffect, useCallback } from 'react';
import Taro from '@tarojs/taro';

interface RequestOptions {
  manual?: boolean;
  onSuccess?: (data: any) => void;
  onError?: (error: any) => void;
}

interface RequestResult<T> {
  data: T | null;
  loading: boolean;
  error: any;
  run: (...args: any[]) => Promise<T>;
  refresh: () => Promise<T>;
}

function useRequest<T = any>(
  service: (...args: any[]) => Promise<T>,
  options: RequestOptions = {}
): RequestResult<T> {
  const { manual = false, onSuccess, onError } = options;

  const [data, setData] = useState<T | null>(null);
  const [loading, setLoading] = useState(!manual);
  const [error, setError] = useState<any>(null);
  const [params, setParams] = useState<any[]>([]);

  const run = useCallback(async (...args: any[]) => {
    setLoading(true);
    setError(null);
    setParams(args);

    try {
      const result = await service(...args);
      setData(result);
      onSuccess?.(result);
      return result;
    } catch (err) {
      setError(err);
      onError?.(err);
      throw err;
    } finally {
      setLoading(false);
    }
  }, [service, onSuccess, onError]);

  const refresh = useCallback(() => {
    return run(...params);
  }, [run, params]);

  useEffect(() => {
    if (!manual) {
      run();
    }
  }, [manual, run]);

  return {
    data,
    loading,
    error,
    run,
    refresh
  };
}

// ä½¿ç”¨ç¤ºä¾‹
// src/pages/product/list.tsx
import React from 'react';
import { View, ScrollView } from '@tarojs/components';
import { usePullDownRefresh, stopPullDownRefresh } from '@tarojs/taro';
import ProductCard from '@/components/ProductCard';
import useRequest from '@/hooks/useRequest';
import { getProductList, addToCart } from '@/services/product';

const ProductList: React.FC = () => {
  const { data: products, loading, refresh } = useRequest(
    () => getProductList({ page: 1, pageSize: 20 }),
    {
      onSuccess: (data) => {
        console.log('å•†å“åˆ—è¡¨åŠ è½½æˆåŠŸ:', data);
      },
      onError: (error) => {
        console.error('å•†å“åˆ—è¡¨åŠ è½½å¤±è´¥:', error);
      }
    }
  );

  const { run: handleAddToCart } = useRequest(addToCart, {
    manual: true,
    onSuccess: () => {
      // å¯ä»¥åœ¨è¿™é‡Œæ›´æ–°è´­ç‰©è½¦æ•°é‡ç­‰
    }
  });

  // ä¸‹æ‹‰åˆ·æ–°
  usePullDownRefresh(async () => {
    try {
      await refresh();
    } finally {
      stopPullDownRefresh();
    }
  });

  return (
    <ScrollView className="product-list" scrollY>
      {products?.map(product => (
        <ProductCard
          key={product.id}
          product={product}
          onAddToCart={handleAddToCart}
        />
      ))}
    </ScrollView>
  );
};

export default ProductList;
```

## æ€§èƒ½ä¼˜åŒ–å’Œæœ€ä½³å®è·µ

<Callout type="warning">
è·¨ç«¯å¼€å‘çš„æ€§èƒ½ä¼˜åŒ–éœ€è¦è€ƒè™‘ä¸åŒå¹³å°çš„ç‰¹æ€§å’Œé™åˆ¶ï¼Œé‡‡ç”¨åˆé€‚çš„ä¼˜åŒ–ç­–ç•¥ã€‚
</Callout>

### å°ç¨‹åºæ€§èƒ½ä¼˜åŒ–

```javascript
// 1. ä»£ç åˆ†åŒ…å’Œæ‡’åŠ è½½
// app.json
{
  "pages": [
    "pages/index/index",
    "pages/list/list"
  ],
  "subPackages": [
    {
      "root": "packageA",
      "name": "pack1",
      "pages": [
        "pages/cat/cat",
        "pages/dog/dog"
      ]
    },
    {
      "root": "packageB",
      "name": "pack2",
      "pages": [
        "pages/apple/apple",
        "pages/banana/banana"
      ],
      "independent": true
    }
  ],
  "preloadRule": {
    "pages/index/index": {
      "network": "all",
      "packages": ["pack1"]
    },
    "pages/list/list": {
      "packages": ["pack2"]
    }
  }
}

// 2. å›¾ç‰‡ä¼˜åŒ–ç­–ç•¥
class ImageOptimizer {
  // å›¾ç‰‡å‹ç¼©
  static compressImage(src, quality = 0.8) {
    return new Promise((resolve, reject) => {
      wx.compressImage({
        src,
        quality,
        success: resolve,
        fail: reject
      });
    });
  }

  // å›¾ç‰‡æ‡’åŠ è½½
  static setupLazyLoad() {
    const observer = wx.createIntersectionObserver();

    observer.relativeToViewport({ bottom: 100 });
    observer.observe('.lazy-image', (res) => {
      if (res.intersectionRatio > 0) {
        const dataset = res.target.dataset;
        const img = res.target;

        // åŠ è½½çœŸå®å›¾ç‰‡
        img.src = dataset.src;
        img.classList.remove('lazy-image');

        observer.unobserve(img);
      }
    });
  }

  // å›¾ç‰‡é¢„åŠ è½½
  static preloadImages(urls) {
    return Promise.all(
      urls.map(url => new Promise((resolve, reject) => {
        wx.getImageInfo({
          src: url,
          success: resolve,
          fail: reject
        });
      }))
    );
  }
}

// 3. æ•°æ®ç¼“å­˜ç­–ç•¥
class CacheManager {
  constructor() {
    this.cache = new Map();
    this.maxSize = 50; // æœ€å¤§ç¼“å­˜æ•°é‡
    this.ttl = 5 * 60 * 1000; // 5åˆ†é’Ÿè¿‡æœŸ
  }

  set(key, data) {
    // æ¸…ç†è¿‡æœŸç¼“å­˜
    this.cleanup();

    // å¦‚æœç¼“å­˜å·²æ»¡ï¼Œåˆ é™¤æœ€æ—§çš„
    if (this.cache.size >= this.maxSize) {
      const firstKey = this.cache.keys().next().value;
      this.cache.delete(firstKey);
    }

    this.cache.set(key, {
      data,
      timestamp: Date.now()
    });

    // åŒæ—¶å­˜å‚¨åˆ°æœ¬åœ°
    try {
      wx.setStorageSync(`cache_${key}`, {
        data,
        timestamp: Date.now()
      });
    } catch (error) {
      console.warn('ç¼“å­˜åˆ°æœ¬åœ°å­˜å‚¨å¤±è´¥:', error);
    }
  }

  get(key) {
    let cached = this.cache.get(key);

    // å¦‚æœå†…å­˜ä¸­æ²¡æœ‰ï¼Œå°è¯•ä»æœ¬åœ°å­˜å‚¨è·å–
    if (!cached) {
      try {
        cached = wx.getStorageSync(`cache_${key}`);
        if (cached) {
          this.cache.set(key, cached);
        }
      } catch (error) {
        console.warn('ä»æœ¬åœ°å­˜å‚¨è¯»å–ç¼“å­˜å¤±è´¥:', error);
      }
    }

    if (!cached) return null;

    // æ£€æŸ¥æ˜¯å¦è¿‡æœŸ
    if (Date.now() - cached.timestamp > this.ttl) {
      this.delete(key);
      return null;
    }

    return cached.data;
  }

  delete(key) {
    this.cache.delete(key);
    try {
      wx.removeStorageSync(`cache_${key}`);
    } catch (error) {
      console.warn('åˆ é™¤æœ¬åœ°ç¼“å­˜å¤±è´¥:', error);
    }
  }

  cleanup() {
    const now = Date.now();
    for (const [key, value] of this.cache.entries()) {
      if (now - value.timestamp > this.ttl) {
        this.delete(key);
      }
    }
  }

  clear() {
    this.cache.clear();
    try {
      const info = wx.getStorageInfoSync();
      info.keys.forEach(key => {
        if (key.startsWith('cache_')) {
          wx.removeStorageSync(key);
        }
      });
    } catch (error) {
      console.warn('æ¸…ç†æœ¬åœ°ç¼“å­˜å¤±è´¥:', error);
    }
  }
}

// 4. ç½‘ç»œè¯·æ±‚ä¼˜åŒ–
class RequestManager {
  constructor() {
    this.cache = new CacheManager();
    this.pendingRequests = new Map();
  }

  async request(options) {
    const { url, data, method = 'GET', useCache = true, cacheTime = 5 * 60 * 1000 } = options;
    const cacheKey = this.getCacheKey(url, data, method);

    // æ£€æŸ¥ç¼“å­˜
    if (useCache && method === 'GET') {
      const cached = this.cache.get(cacheKey);
      if (cached) {
        return cached;
      }
    }

    // æ£€æŸ¥æ˜¯å¦æœ‰ç›¸åŒçš„è¯·æ±‚æ­£åœ¨è¿›è¡Œ
    if (this.pendingRequests.has(cacheKey)) {
      return this.pendingRequests.get(cacheKey);
    }

    // å‘èµ·è¯·æ±‚
    const requestPromise = new Promise((resolve, reject) => {
      wx.request({
        url,
        data,
        method,
        success: (res) => {
          if (res.statusCode === 200) {
            // ç¼“å­˜GETè¯·æ±‚ç»“æœ
            if (useCache && method === 'GET') {
              this.cache.set(cacheKey, res.data);
            }
            resolve(res.data);
          } else {
            reject(new Error(`Request failed with status ${res.statusCode}`));
          }
        },
        fail: reject,
        complete: () => {
          this.pendingRequests.delete(cacheKey);
        }
      });
    });

    this.pendingRequests.set(cacheKey, requestPromise);
    return requestPromise;
  }

  getCacheKey(url, data, method) {
    return `${method}_${url}_${JSON.stringify(data || {})}`;
  }
}

// 5. æ€§èƒ½ç›‘æ§
class PerformanceMonitor {
  constructor() {
    this.metrics = {};
    this.setupMonitoring();
  }

  setupMonitoring() {
    // ç›‘æ§é¡µé¢æ€§èƒ½
    const originalPage = Page;
    Page = (options) => {
      const originalOnLoad = options.onLoad;
      const originalOnShow = options.onShow;

      options.onLoad = function(...args) {
        const startTime = Date.now();
        this._loadStartTime = startTime;

        if (originalOnLoad) {
          originalOnLoad.apply(this, args);
        }

        // é¡µé¢åŠ è½½å®Œæˆåè®°å½•æ—¶é—´
        wx.nextTick(() => {
          const loadTime = Date.now() - startTime;
          console.log(`é¡µé¢åŠ è½½æ—¶é—´: ${loadTime}ms`);

          // ä¸ŠæŠ¥æ€§èƒ½æ•°æ®
          this.reportPerformance?.({
            type: 'pageLoad',
            page: this.route,
            duration: loadTime
          });
        });
      };

      options.onShow = function(...args) {
        this._showStartTime = Date.now();

        if (originalOnShow) {
          originalOnShow.apply(this, args);
        }
      };

      return originalPage(options);
    };

    // ç›‘æ§ç½‘ç»œè¯·æ±‚
    const originalRequest = wx.request;
    wx.request = (options) => {
      const startTime = Date.now();
      const originalSuccess = options.success;
      const originalFail = options.fail;

      options.success = function(res) {
        const duration = Date.now() - startTime;
        console.log(`è¯·æ±‚è€—æ—¶: ${options.url} - ${duration}ms`);

        if (originalSuccess) {
          originalSuccess(res);
        }
      };

      options.fail = function(error) {
        const duration = Date.now() - startTime;
        console.log(`è¯·æ±‚å¤±è´¥: ${options.url} - ${duration}ms`, error);

        if (originalFail) {
          originalFail(error);
        }
      };

      return originalRequest(options);
    };
  }

  reportPerformance(data) {
    // ä¸ŠæŠ¥æ€§èƒ½æ•°æ®åˆ°æœåŠ¡å™¨
    wx.request({
      url: '/api/performance',
      method: 'POST',
      data: {
        ...data,
        timestamp: Date.now(),
        platform: 'miniprogram'
      }
    });
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const cacheManager = new CacheManager();
const requestManager = new RequestManager();
const performanceMonitor = new PerformanceMonitor();

// åœ¨åº”ç”¨å¯åŠ¨æ—¶åˆå§‹åŒ–
App({
  onLaunch() {
    // åˆå§‹åŒ–æ€§èƒ½ç›‘æ§
    performanceMonitor.setupMonitoring();

    // é¢„åŠ è½½å…³é”®å›¾ç‰‡
    ImageOptimizer.preloadImages([
      '/images/logo.png',
      '/images/default-avatar.png'
    ]);
  }
});
```

---

<Callout type="success">
å°ç¨‹åºå’Œè·¨ç«¯å¼€å‘ä¸ºå‰ç«¯å¼€å‘è€…æä¾›äº†æ›´å¹¿é˜”çš„åº”ç”¨åœºæ™¯ï¼ŒæŒæ¡è¿™äº›æŠ€æœ¯èƒ½å¤Ÿè®©ä½ çš„åº”ç”¨è¦†ç›–æ›´å¤šå¹³å°å’Œç”¨æˆ·ã€‚
</Callout>

---

## ğŸ“š å‚è€ƒå­¦ä¹ èµ„æ–™

### ğŸ“– å®˜æ–¹æ–‡æ¡£
- [å¾®ä¿¡å°ç¨‹åºå®˜æ–¹æ–‡æ¡£](https://developers.weixin.qq.com/miniprogram/dev/framework/) - å¾®ä¿¡å°ç¨‹åºæƒå¨æ–‡æ¡£
- [uni-app å®˜æ–¹æ–‡æ¡£](https://uniapp.dcloud.net.cn/) - uni-appè·¨ç«¯å¼€å‘æ¡†æ¶
- [Taro å®˜æ–¹æ–‡æ¡£](https://taro.jd.com/) - äº¬ä¸œTaroå¤šç«¯ç»Ÿä¸€å¼€å‘æ¡†æ¶
- [æ”¯ä»˜å®å°ç¨‹åºæ–‡æ¡£](https://opendocs.alipay.com/mini) - æ”¯ä»˜å®å°ç¨‹åºå¼€å‘æŒ‡å—

### ğŸ“ ä¼˜è´¨æ•™ç¨‹
- [å¾®ä¿¡å°ç¨‹åºå¼€å‘æ•™ç¨‹](https://developers.weixin.qq.com/miniprogram/dev/framework/quickstart/) - å®˜æ–¹å¿«é€Ÿå…¥é—¨
- [uni-app ä»å…¥é—¨åˆ°å®æˆ˜](https://uniapp.dcloud.net.cn/tutorial/) - uni-appå®˜æ–¹æ•™ç¨‹
- [Taro å®æˆ˜æ•™ç¨‹](https://taro-docs.jd.com/taro/docs/tutorial) - Taroå¼€å‘å®æˆ˜

### ğŸ› ï¸ å®è·µé¡¹ç›®
- [å¾®ä¿¡å°ç¨‹åºç¤ºä¾‹](https://github.com/wechat-miniprogram/miniprogram-demo) - å®˜æ–¹ç¤ºä¾‹é¡¹ç›®
- [uni-app æ’ä»¶å¸‚åœº](https://ext.dcloud.net.cn/) - uni-appæ’ä»¶å’Œæ¨¡æ¿
- [Taro ç‰©æ–™å¸‚åœº](https://taro-ext.jd.com/) - Taroç»„ä»¶å’Œæ¨¡æ¿

### ğŸ”§ å¼€å‘å·¥å…·
- [å¾®ä¿¡å¼€å‘è€…å·¥å…·](https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html) - å¾®ä¿¡å°ç¨‹åºIDE
- [HBuilderX](https://www.dcloud.io/hbuilderx.html) - uni-appå®˜æ–¹IDE
- [Taro CLI](https://taro-docs.jd.com/taro/docs/GETTING-STARTED) - Taroå‘½ä»¤è¡Œå·¥å…·
- [å°ç¨‹åºå¼€å‘åŠ©æ‰‹](https://developers.weixin.qq.com/miniprogram/dev/devtools/ext.html) - å¼€å‘è¾…åŠ©å·¥å…·

### ğŸ“ æ·±å…¥é˜…è¯»
- [å°ç¨‹åºæ€§èƒ½ä¼˜åŒ–](https://developers.weixin.qq.com/miniprogram/dev/framework/performance/) - å¾®ä¿¡å°ç¨‹åºæ€§èƒ½æŒ‡å—
- [è·¨ç«¯å¼€å‘æœ€ä½³å®è·µ](https://uniapp.dcloud.net.cn/tutorial/best-practices.html) - uni-appæœ€ä½³å®è·µ
- [å¤šç«¯ç»Ÿä¸€å¼€å‘æ€è€ƒ](https://aotu.io/notes/2018/06/25/the-birth-of-taro/index.html) - Taroè®¾è®¡æ€æƒ³

<Callout type="tip">
ğŸ’¡ **å­¦ä¹ å»ºè®®**ï¼šå»ºè®®ä»å¾®ä¿¡å°ç¨‹åºå¼€å§‹å­¦ä¹ å°ç¨‹åºå¼€å‘åŸºç¡€ï¼Œç„¶åé€‰æ‹©uni-appæˆ–Taroå­¦ä¹ è·¨ç«¯å¼€å‘ï¼Œé‡ç‚¹æŒæ¡æ€§èƒ½ä¼˜åŒ–å’Œå¹³å°å·®å¼‚å¤„ç†ã€‚
</Callout>
